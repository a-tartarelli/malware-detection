from os import walk
from bs4 import BeautifulSoup
import csv

goodwareApiList = []
for (dirpath, dirnames, filenames) in walk('dataset/apiGoodware'):
    goodwareApiList.extend(filenames)
    break

def XmlToCsv(xmlApiSequence):
    # Reading the data inside the xml
    # file to a variable under the name
    # data
    with open('dataset/apiGoodware/' + xmlApiSequence, 'rb') as f:
        data = f.read()
    
    # Passing the stored data inside
    # the beautifulsoup parser, storing
    # the returned object
    Bs_data = BeautifulSoup(data, "xml")
    
    # Finding all instances of tag
    # `unique`
    b_api = Bs_data.find_all('Api')
    
    #print(b_api)
    
    # Using find() to extract attributes
    # of the first instance of the tag
    #b_name = Bs_data.find('child', {'name':'Frank'})
    
    #print(b_name)
    
    # Extracting the data stored in a
    # specific attribute of the
    # `child` tag

    apiSequence = []
    #print(xmlApiSequence[:-4])
    apiSequence.append(xmlApiSequence[:-4])

    for apiName in b_api:
        value = apiName.get('Name')
        apiSequence.append(value)

    #print(apiSequence)
    with open("./goodwareApimds.csv", 'a') as f:
      
        # using csv.writer method from CSV package
        write = csv.writer(f)
      
        write.writerow(apiSequence)



if __name__ == '__main__':
    #print(goodwareApiList)
    #print(len(goodwareApiList))

    #XmlToCsv(goodwareApiList[1])

    for prog in goodwareApiList:
        print(prog)
        XmlToCsv(prog)
        
