import csv
from os import walk
import pandas as pd
from requests import head


programsDone = []
for (dirpath, dirnames, filenames) in walk('dataset/outUser/'):
    programsDone.extend(filenames)
    break

goodware = open("goodwareUser.csv", "w")
writer = csv.writer(goodware)



def writeHeader():
    header = ["Column"+str(number) for number in range(3, 110)]
    writer.writerow(header)



def extractApiCalls():
    for program in programsDone:
        f = open("dataset/outUser/" + program, "r")
        apiCalls = []
        count = 0

        for line in f:
            
            if line.startswith("Nt"):
                count = count + 1
                call = line.split("(")
                #print(call[0])
                #print(count)
                if count < 108:
                    apiCalls.append(call[0])
                else:
                    break      
            
        #print(len(apiCalls))
        writer.writerow(apiCalls)
        f.close()

    goodware.close()
    #print(apiCalls)



if __name__ == "__main__":
    #df = pd.read_csv("goodware.csv", header=None)
    #df.insert(0, 'Name', 'placeholder')


    #print(df.head())
    #Column3
    #df.to_csv("finalGoodware.csv", header=False, index=False)
    writeHeader()
    extractApiCalls()